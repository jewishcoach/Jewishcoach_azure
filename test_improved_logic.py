#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""Test the improved frustration logic"""

def user_wants_to_continue(msg):
    """Check if user is frustrated"""
    signals = ["×›×ª×‘×ª×™ ×œ×š", "×œ× ×§×¨×” ×›×œ×•×", "×‘×•× × ××©×™×š", "××” ×¢×›×©×™×•", "×“×™"]
    return any(s in msg for s in signals)

def has_sufficient_event_details(messages):
    """Check if we have enough event details"""
    user_msgs = [m["content"] for m in messages if m["sender"] == "user"]
    
    if len(user_msgs) < 2:
        return False, "need_more_responses"
    
    total_length = sum(len(m) for m in user_msgs)
    if total_length < 40:
        return False, "responses_too_short"
    
    detail_words = ["××™", "××™×¤×”", "×××¨", "×¢×©×”", "×”×’×™×‘", "×§×¨×”"]
    all_text = " ".join(user_msgs)
    if not any(word in all_text for word in detail_words):
        return False, "missing_details"
    
    return True, ""

print("=" * 80)
print("×ª×¨×—×™×© 1: ×ª×¡×›×•×œ ×œ×œ× ××™×“×¢ ××¡×¤×™×§")
print("=" * 80)

conv1 = {"messages": [
    {"sender": "coach", "content": "××” ×§×¨×”?"},
    {"sender": "user", "content": "×”×™× ×¦×¢×§×”"}
]}

print("\nğŸ‘¤ ××©×ª××©: '×”×™× ×¦×¢×§×”' (10 ×ª×•×•×™×, ××™×Ÿ ×¤×¨×˜×™×)")
print("ğŸ¤– ××××Ÿ: '××” ×¢×•×“ ×§×¨×” ×‘××•×ª×• ×¨×’×¢?'")
print("ğŸ‘¤ ××©×ª××©: '×œ× ×§×¨×” ×›×œ×•×, ×‘×•× × ××©×™×š'")

conv1["messages"].append({"sender": "user", "content": "×œ× ×§×¨×” ×›×œ×•×, ×‘×•× × ××©×™×š"})

frustrated = user_wants_to_continue("×œ× ×§×¨×” ×›×œ×•×, ×‘×•× × ××©×™×š")
has_info, reason = has_sufficient_event_details(conv1["messages"])

print(f"\nğŸ” ×‘×“×™×§×•×ª:")
print(f"   user_wants_to_continue() = {frustrated}")
print(f"   has_sufficient_event_details() = {has_info} (×¡×™×‘×”: {reason})")

print("\nğŸ“‹ ×”×—×œ×˜×”:")
if frustrated and not has_info:
    print("   âš ï¸ ×™×© ×ª×¡×›×•×œ ××‘×œ ×—×¡×¨ ××™×“×¢ â†’ ××¡×‘×™×¨ ×œ××©×ª××©!")
    print("\nğŸ¤– ××××Ÿ ××¡×‘×™×¨:")
    print("   '×× ×™ ××‘×™×Ÿ ×©××ª×” ×¨×•×¦×” ×œ×”××©×™×š.")
    print("    ×”×¡×™×‘×” ×©×× ×™ ×¦×¨×™×š ×¢×•×“ ×¤×¨×˜×™× ×”×™× ×©×›×“×™ ×œ×–×”×•×ª ××ª ×”×“×¤×•×¡ ×©×œ×š,")
    print("    ×× ×™ ×¦×¨×™×š ×œ×”×‘×™×Ÿ ××ª ×”××¦×‘ ×”××œ×.")
    print("    ×¡×¤×¨ ×œ×™ ×‘×‘×§×©×” - ××™ ×”×™×” ×©×? ××” ×‘×“×™×•×§ × ×××¨?'")
else:
    print("   âŒ ×œ× ×××•×¨ ×œ×”×’×™×¢ ×œ×›××Ÿ!")

print("\n" + "=" * 80)
print("×ª×¨×—×™×© 2: ×ª×¡×›×•×œ ×¢× ××™×“×¢ ××¡×¤×™×§")
print("=" * 80)

conv2 = {"messages": [
    {"sender": "coach", "content": "××” ×§×¨×”?"},
    {"sender": "user", "content": "×”×™× ×¦×¢×§×” ×¢×œ×™ ×‘×¤×’×™×©×”"},
    {"sender": "coach", "content": "××” ×¢×•×“ ×§×¨×”?"},
    {"sender": "user", "content": "×”×™× ×××¨×” ×©×× ×™ ×œ× ××¡×¤×™×§ ×˜×•×‘ ×•×©×”×‘×•×¡ ×™×™×ª×Ÿ ×œ×” ××ª ×”×¤×¨×•×™×§×˜"}
]}

print("\nğŸ‘¤ ××©×ª××©: '×”×™× ×¦×¢×§×” ×¢×œ×™ ×‘×¤×’×™×©×”' (24 ×ª×•×•×™×)")
print("ğŸ¤– ××××Ÿ: '××” ×¢×•×“ ×§×¨×”?'")
print("ğŸ‘¤ ××©×ª××©: '×”×™× ×××¨×” ×©×× ×™ ×œ× ××¡×¤×™×§ ×˜×•×‘...' (62 ×ª×•×•×™×)")
print("ğŸ¤– ××××Ÿ: '×¡×¤×¨ ×œ×™ ×¢×•×“ ×¢×œ ×”×¨×’×¢ ×”×–×”'")
print("ğŸ‘¤ ××©×ª××©: '×“×™, ×‘×•× × ××©×™×š'")

conv2["messages"].append({"sender": "user", "content": "×“×™, ×‘×•× × ××©×™×š"})

frustrated = user_wants_to_continue("×“×™, ×‘×•× × ××©×™×š")
has_info, reason = has_sufficient_event_details(conv2["messages"])

print(f"\nğŸ” ×‘×“×™×§×•×ª:")
print(f"   user_wants_to_continue() = {frustrated}")
print(f"   has_sufficient_event_details() = {has_info}")

print("\nğŸ“‹ ×”×—×œ×˜×”:")
if frustrated and has_info:
    print("   âœ… ×™×© ×ª×¡×›×•×œ ×•×™×© ××™×“×¢ ××œ× â†’ ×××¤×©×¨ ××¢×‘×¨ ×œ-S3!")
    print("\nğŸ¤– ××××Ÿ ×¢×•×‘×¨ ×œ×¨×’×©×•×ª:")
    print("   '××” ×”×¨×’×©×ª ×‘××•×ª×• ×¨×’×¢ ×›×©×”×™× ×××¨×” ××ª ×–×”?'")
else:
    print("   âŒ ×œ× ×××•×¨ ×œ×”×’×™×¢ ×œ×›××Ÿ!")

print("\n" + "=" * 80)
print("×ª×¨×—×™×© 3: ××™×Ÿ ×ª×¡×›×•×œ, ×–×¨×™××” ×¨×’×™×œ×”")
print("=" * 80)

conv3 = {"messages": [
    {"sender": "coach", "content": "××” ×§×¨×”?"},
    {"sender": "user", "content": "×”×™×™×ª×” ×œ×™ ×¤×’×™×©×” ×¢× ×”×× ×”×œ"}
]}

print("\nğŸ‘¤ ××©×ª××©: '×”×™×™×ª×” ×œ×™ ×¤×’×™×©×” ×¢× ×”×× ×”×œ' (30 ×ª×•×•×™×)")
print("ğŸ¤– ××××Ÿ: '××” ×¢×•×“ ×§×¨×” ×‘××•×ª×• ×¨×’×¢?'")
print("ğŸ‘¤ ××©×ª××©: '×”×•× ×××¨ ×©×× ×™ ×¦×¨×™×š ×œ×¢×‘×•×“ ×™×•×ª×¨ ×§×©×”'")

conv3["messages"].append({"sender": "user", "content": "×”×•× ×××¨ ×©×× ×™ ×¦×¨×™×š ×œ×¢×‘×•×“ ×™×•×ª×¨ ×§×©×”"})

frustrated = user_wants_to_continue("×”×•× ×××¨ ×©×× ×™ ×¦×¨×™×š ×œ×¢×‘×•×“ ×™×•×ª×¨ ×§×©×”")
has_info, reason = has_sufficient_event_details(conv3["messages"])

print(f"\nğŸ” ×‘×“×™×§×•×ª:")
print(f"   user_wants_to_continue() = {frustrated}")
print(f"   has_sufficient_event_details() = {has_info}")

print("\nğŸ“‹ ×”×—×œ×˜×”:")
if not frustrated:
    if has_info:
        print("   âœ… ××™×Ÿ ×ª×¡×›×•×œ ×•×™×© ××™×“×¢ â†’ ×××¤×©×¨ ××¢×‘×¨ ×œ-S3!")
    else:
        print(f"   âš ï¸ ××™×Ÿ ×ª×¡×›×•×œ ××‘×œ ×¨×§ 2 turns â†’ ×××©×™×š ×œ×©××•×œ")
        print("\nğŸ¤– ××××Ÿ:")
        print("   '××™×š ×–×” ×”×ª×¤×ª×—? ××” ×§×¨×” ××—×¨×™ ×–×”?'")

print("\n" + "=" * 80)
print("ğŸ“Š ×¡×™×›×•×")
print("=" * 80)
print("""
×˜×‘×œ×ª ×”×©×•×•××”:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ××¦×‘                    â”‚ ×œ×•×’×™×§×” ×™×©× ×” âŒ      â”‚ ×œ×•×’×™×§×” ×—×“×©×” âœ…      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×ª×¡×›×•×œ + ×—×¡×¨ ××™×“×¢      â”‚ ××“×œ×’ ×§×“×™××”         â”‚ ××¡×‘×™×¨ ×œ××” ×¦×¨×™×š     â”‚
â”‚ ×ª×¡×›×•×œ + ×™×© ××™×“×¢       â”‚ ×××¤×©×¨ ××¢×‘×¨         â”‚ ×××¤×©×¨ ××¢×‘×¨         â”‚
â”‚ ××™×Ÿ ×ª×¡×›×•×œ + ×™×© ××™×“×¢   â”‚ ×××¤×©×¨ ××¢×‘×¨         â”‚ ×××¤×©×¨ ××¢×‘×¨         â”‚
â”‚ ××™×Ÿ ×ª×¡×›×•×œ + ×—×¡×¨ ××™×“×¢  â”‚ ×©×•××œ ×©×•×‘           â”‚ ×©×•××œ ×©×•×‘           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

×”×¢×™×§×¨×•×Ÿ:
â€¢ ×ª×¡×›×•×œ = SIGNAL (××™× ×“×™×§×˜×•×¨), ×œ× COMMAND (×¤×§×•×“×”)
â€¢ ×ª××™×“ ×‘×•×“×§×™× ×× ×™×© ××¡×¤×™×§ ××™×“×¢
â€¢ ×× ×—×¡×¨ â†’ ××¡×‘×™×¨×™× ×œ××©×ª××© ×œ××” ×–×” ×—×©×•×‘
â€¢ ×”×ª×•×¦××”: ××©×ª××© ××‘×™×Ÿ + × ×•×ª×Ÿ ××™×“×¢ ××™×›×•×ª×™
""")

print("\nâœ… ×¡×™××•×œ×¦×™×” ×”×•×©×œ××”!")
